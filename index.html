<!DOCTYPE html>
<html>
<head>
  <title>Pooping Block Game</title>
  <style>
    body {
      text-align: center;
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      overflow: hidden;
      display: flex;
      align-items: flex-end;
      justify-content: center;
      height: 92.5vh;
    }

    #gameCanvas {
      background-color: #f0f0f0;
      border: 1px solid #999;
      display: block;
      width: 40vw;
      height: 85vh;
    }
  </style>
</head>
<body>
  <canvas id="gameCanvas"></canvas>

  <script>
    var canvas = document.getElementById('gameCanvas');
    var ctx = canvas.getContext('2d');

    var isGameOver = false;
    var score = 100;

    var playerImage;
    var player = {
      x: canvas.width / 10,              // Starting position of the player on the x-axis
      y: canvas.height / 5,              // Starting position of the player on the y-axis
      width: canvas.width * 0.08,        // Width of the player using vw unit
      height: canvas.height * 0.07,      // Height of the player using vh unit
      velocityX: 0,                      // Velocity of the player on the x-axis
      velocityY: 0,                      // Velocity of the player on the y-axis
      isMovingLeft: false,               // Track if the player is moving left
      isMovingRight: false,              // Track if the player is moving right
      isJumping: false                   // Track if the player is jumping
    };

    // Load player images
    var playerImageRight = new Image();
    playerImageRight.src = 'BirdRight.png';

    var playerImageLeft = new Image();
    playerImageLeft.src = 'BirdLeft.png';

    // Set initial player image
    playerImage = playerImageRight;

    // Block variables
    var blocks = [];
    var enemyBlocks = [];
    var blockWidth = 30;
    var blockHeight = 30;
    var blockSpeeds = {
      red: 2,    // Speed for red block (interval: 2 seconds)
      blue: 1,   // Speed for blue block (interval: 1 second)
      green: 3   // Speed for green block (interval: 3 seconds)
    };

    // Handle keydown event for left and right arrow keys and Space key
    document.addEventListener('keydown', function(event) {
      if (event.code === 'ArrowLeft') {
        player.isMovingLeft = true;
        player.isMovingRight = false;
        playerImage = playerImageLeft;
      } else if (event.code === 'ArrowRight') {
        player.isMovingRight = true;
        player.isMovingLeft = false;
        playerImage = playerImageRight;
      } else if (event.code === 'Space') {
        if (isGameOver) {
          restartGame();
        } else {
      if (score < 10) {
        score = 0;
        gameOver();
      } else {
        score -= 10;
        player.y -= 2.5;
        dropBlock();
      }
    }
  }
});

    // Handle keyup event for left and right arrow keys
    document.addEventListener('keyup', function(event) {
      if (event.code === 'ArrowLeft') {
        player.isMovingLeft = false;
      } else if (event.code === 'ArrowRight') {
        player.isMovingRight = false;
      }
    });

    // Game over function
    function gameOver() {
      // Stop the game or perform any desired game over actions
      player.isMovingLeft = false;
      player.isMovingRight = false;

      // Set game over state
      isGameOver = true;
    }

    // Restart the game
    function restartGame() {
      isGameOver = false;
      score = 100;
      player.x = canvas.width / 10;
      player.y = canvas.height / 5;
      player.velocityX = 0;
      player.velocityY = 0;
      player.isMovingLeft = false;
      player.isMovingRight = false;
      playerImage = playerImageRight;
      blocks = []; // Clear blocks array
      enemyBlocks = []; // Clear enemy blocks array
      gameLoop();
    }

    // Update player position
function updatePlayerPosition() {
  // Apply gravity
  player.velocityY += 0.0005;
  player.y += player.velocityY;

  // Move player left or right
  if (player.isMovingLeft) {
    player.velocityX = -5;
  } else if (player.isMovingRight) {
    player.velocityX = 5;
  } else {
    player.velocityX = 0;
  }

  player.x += player.velocityX;

  // Restrict player within the canvas boundaries
  if (player.x < 0) {
    player.x = 0;
  } else if (player.x + player.width > canvas.width) {
    player.x = canvas.width - player.width;
  }

  if (player.y < 0) {
    player.y = 0;
  } else if (player.y + player.height > canvas.height) {
    gameOver();
  }

  // Slow down the player's jump when reaching a height of 20 pixels
  if (player.y <= 20 && player.isJumping) {
    player.velocityY *= 0.9; // Adjust the factor to control the jump speed
    if (player.velocityY > -0.01) {
      player.isJumping = false;
    }
  }
}


    // Function to drop a block from the player
    function dropBlock() {
      var block = {
        x: player.x + player.width / 2,   // X position of the block (centered above the player)
        y: player.y + player.height,      // Y position of the block (above the player)
        width: 5,                         // Width of the block
        height: 5,                        // Height of the block
        velocityX: 0,                     // Velocity of the block on the X-axis (initialized as 0)
        velocityY: 5                      // Velocity of the block on the Y-axis (moving downwards)
      };

      blocks.push(block);
    }

    // Function to spawn an enemy red block
    function spawnEnemyBlock() {
      var enemyBlock = {
        x: canvas.width,                 // Starting position of the enemy block on the x-axis (right side of the canvas)
        y: canvas.height - blockHeight,  // Starting position of the enemy block on the y-axis (bottom of the canvas)
        width: blockWidth,               // Width of the enemy block
        height: blockHeight,             // Height of the enemy block
        velocityX: -2                    // Velocity of the enemy block on the X-axis (moving left)
      };

      enemyBlocks.push(enemyBlock);
    }

    // Update block positions
function updateBlockPositions() {
  // Update regular blocks
  for (var i = 0; i < blocks.length; i++) {
    var block = blocks[i];
    block.x += block.velocityX;
    block.y += block.velocityY;

    // Remove blocks that have fallen off the canvas
    if (block.y > canvas.height) {
      blocks.splice(i, 1);
      i--;
    }
  }

  // Update enemy blocks
  for (var j = 0; j < enemyBlocks.length; j++) {
    var enemyBlock = enemyBlocks[j];
    enemyBlock.x += enemyBlock.velocityX;

    // Remove enemy blocks that have moved past the canvas
    if (enemyBlock.x + enemyBlock.width < 0) {
      enemyBlocks.splice(j, 1);
      j--;
    }

    // Check for collision with the player
    if (
      player.x < enemyBlock.x + enemyBlock.width &&
      player.x + player.width > enemyBlock.x &&
      player.y < enemyBlock.y + enemyBlock.height &&
      player.y + player.height > enemyBlock.y
    ) {
      gameOver();
    }

    // Check for collision with the dropped block
    for (var k = 0; k < blocks.length; k++) {
      var block = blocks[k];
      if (
        block.x < enemyBlock.x + enemyBlock.width &&
        block.x + block.width > enemyBlock.x &&
        block.y < enemyBlock.y + enemyBlock.height &&
        block.y + block.height > enemyBlock.y
      ) {
        // Remove the collided block and enemy block
        blocks.splice(k, 1);
        enemyBlocks.splice(j, 1);
        k--;
        j--;

        // Increase the score
        score += 50;
      player.y -= 2.5;
      blocks.splice(i, 1);
      i--;
      }
    }
  }
}


    // Draw the player
    function drawPlayer() {
      ctx.drawImage(playerImage, player.x, player.y, player.width, player.height);
    }

    // Draw the blocks
    function drawBlocks() {
      ctx.fillStyle = 'black';
      for (var i = 0; i < blocks.length; i++) {
        var block = blocks[i];
        ctx.fillRect(block.x, block.y, block.width, block.height);
      }
    }

    // Draw the enemy blocks
    function drawEnemyBlocks() {
      ctx.fillStyle = 'red';
      for (var i = 0; i < enemyBlocks.length; i++) {
        var enemyBlock = enemyBlocks[i];
        ctx.fillRect(enemyBlock.x, enemyBlock.y, enemyBlock.width, enemyBlock.height);
      }
    }

    // Draw the score
    function drawScore() {
      ctx.fillStyle = 'black';
      ctx.font = '24px Arial';
      ctx.fillText('Score: ' + score, 10, 30);
    }

    // Game loop
    function gameLoop() {
      // Clear canvas
      ctx.clearRect(0, 0, canvas.width, canvas.height);

      if (!isGameOver) {
        updatePlayerPosition();
        updateBlockPositions();

        // Spawn enemy blocks at regular intervals
        if (Math.random() < 0.01) {
          spawnEnemyBlock();
        }

        drawPlayer();
        drawBlocks();
        drawEnemyBlocks();
        drawScore();

        // Request next frame
        requestAnimationFrame(gameLoop);
      } else {
        // Game over state
        ctx.fillStyle = 'black';
        ctx.font = '36px Arial';
        ctx.fillText('Game Over', canvas.width / 2 - 80, canvas.height / 2);
        ctx.fillText('Press Space to Restart', canvas.width / 2 - 140, canvas.height / 2 + 40);
      }
    }

    // Start the game loop
    gameLoop();
  </script>
</body>
</html>
